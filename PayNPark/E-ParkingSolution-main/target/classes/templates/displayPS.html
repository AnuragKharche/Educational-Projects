<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<link href="/css/style.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<head>
  <meta charset="UTF-8">
  <title>Book Spaces</title>
</head>
<!--The nav bar-->
<nav class="navbar navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="/indexDriver">
      <img src="/images/logo.png" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
      E-Parking Solution
    </a>
    <ul class="nav justify-content-end">
      <li class="nav-item">
        <a  class="nav-link" href="/indexDriver" style="color: darkgrey">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
            <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5ZM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5 5 5Z"/>
          </svg>
          Home</a>
      </li>
      <li class="nav-item">
        <a  class="nav-link active" aria-current="page" href="/booking" style="color: white">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-plus" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
          </svg>
          Book</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/myBookings" style="color: darkgrey">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-journal-bookmark-fill" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M6 1h6v7a.5.5 0 0 1-.757.429L9 7.083 6.757 8.43A.5.5 0 0 1 6 8V1z"/>
            <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2z"/>
            <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1H1z"/>
          </svg>
          My Bookings</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/driverInbox" style="color: darkgrey">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-inbox" viewBox="0 0 16 16">
            <path d="M4.98 4a.5.5 0 0 0-.39.188L1.54 8H6a.5.5 0 0 1 .5.5 1.5 1.5 0 1 0 3 0A.5.5 0 0 1 10 8h4.46l-3.05-3.812A.5.5 0 0 0 11.02 4H4.98zm9.954 5H10.45a2.5 2.5 0 0 1-4.9 0H1.066l.32 2.562a.5.5 0 0 0 .497.438h12.234a.5.5 0 0 0 .496-.438L14.933 9zM3.809 3.563A1.5 1.5 0 0 1 4.981 3h6.038a1.5 1.5 0 0 1 1.172.563l3.7 4.625a.5.5 0 0 1 .105.374l-.39 3.124A1.5 1.5 0 0 1 14.117 13H1.883a1.5 1.5 0 0 1-1.489-1.314l-.39-3.124a.5.5 0 0 1 .106-.374l3.7-4.625z"/>
          </svg>
          Inbox</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/logout" style="color: darkgrey">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
            <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1z"/>
            <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117zM11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5zM4 1.934V15h6V1.077l-6 .857z"/>
          </svg>
          Logout</a>
      </li>
    </ul>
  </div>
</nav>
<body style="Background-color:#8dd5d862">
<br>
<style>
  .card {
    margin: auto;
    width: 30%;
  }

  .form-group {
    margin: auto;
    width: 30%;
  }

  .busy-time-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: #f8f9fa;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #dee2e6;
    border-radius: 5px;
    width: 100%;
  }

  .busy-time-datetime {
    margin: 2px 0;
    word-wrap: break-word;
  }
</style>

<p>Welcome <span sec:authentication="name" style="color: #ffde25">Username</span>, Secure Your Spot, Enjoy the Drive - Book Parking Now!</p><br>
<br>
<div class="card">
  <div class="card-header">
    Parking Space Details
  </div>
  <div class="payment-details">
    <p class="card-text">Parking Space ID: <span th:text="${parkingSpace.id_ps}"></span></p>
    <p class="card-text">Disabled Space: <span th:text="${parkingSpace.disabledSpace}"></span></p>
    <p class="card-text">Floor Level: <span th:text="${parkingSpace.floorLevel}"></span></p>
    <p class="card-text">Enabled: <span th:text="${parkingSpace.enabled}"></span></p>
    <p class="card-text">Price per 30 minutes: <span th:text="${parkingSpace.price} + 'Rs'"></span></p>
    <p class="card-text">Car Park Name: <span th:text="${parkingSpace.carPark.name}"></span></p>
  </div>

  <div class="container">
    <div class="parking-space-header">
      <h2>Parking Space Availability</h2>
    </div>
    <div class="busy-times-section">
      <h4 style="text-align: center">Busy Times:</h4><br>
<!--      if empty -->
      <div th:if="${transactions} == null" class="empty-state-container">
        <div class="empty-state-message">
          <p th:text="${message}" class="empty-state-text"></p>
        </div>
      </div>

      <div class="busy-times-container">
        <div class="busy-time-block" th:each="transaction : ${transactions}">
          <span class="busy-time-datetime" th:text="${#temporals.format(transaction.startDate, 'MMM d, yyyy')} + ' ' + ${#temporals.format(transaction.startTime, 'hh:mm a')} + ' - '"></span>
          <span class="busy-time-datetime" th:text="${#temporals.format(transaction.endDate, 'MMM d, yyyy')} + ' ' + ${#temporals.format(transaction.endTime, 'hh:mm a')}"></span>
        </div>
      </div>

    </div>
  </div>


</div>
<br>
<p th:if="${errorMessage}" th:text="${errorMessage}" style="color: red;"></p>
<form action="#" th:action="@{/booking/parking-space/{id_ps}(id_ps=${parkingSpace.id_ps})}" th:method="post">
  <div class="form-group">
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate" name="startDate" class="form-control" required/>
  </div>
  <div class="form-group">
    <label for="startTime">Start Time:</label>
    <input type="time" id="startTime" name="startTime" class="form-control" required/>
  </div>
  <div class="form-group">
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate" name="endDate" class="form-control" required/>
  </div>
  <div class="form-group">
    <label for="endTime">End Time:</label>
    <input type="time" id="endTime" name="endTime" class="form-control" required/>
  </div>
  <div class="form-group">
    <label for="licensePlate">License Plate:</label>
    <input type="text" id="licensePlate" name="licensePlate" class="form-control" required/>
  </div><br>
  <div class="text-center">
    <button type="submit" class="btn btn-primary">Book</button>
    <button type="button" class="btn btn-secondary" onclick="goBack()">Go Back</button>
  </div>
</form><br>

<script>
  function goBack() {
    window.history.back();
  }
</script>

</div>
</body>
</html>
